))
deaths_plot <-
deaths_filter %>%
ggplot() +
geom_hline(yintercept = 0, size = 1, color = "#333333") +
geom_line(aes(x = as.Date(year, format = "%Y"),
y = value,
color = age), size = 1) +
bbc_style() +
scale_color_manual(
values = c("#990000",
"#588300",
"#AD08F9",
"#06BF8E",
"#FFA31E",
"#1380A1")
) +
labs(
title = "Количество смертей на 1 тысячу человек",
subtitle = glue("{deaths_filter$reg[1]}, городское население")
) +
guides(color = guide_legend(ncol = 2, byrow = FALSE))
finalise_plot(
deaths_plot,
save_filepath = glue("charts/{deaths_filter$reg[1]}.png"),
source_name = "Источник: Росстат"
)
deaths_filter <- deaths_urb %>%
filter(grepl("Петербург ", reg) &
age %in% age_groups)
deaths_filter$age <-
factor(deaths_filter$age,
levels = c(
"85 и старше",
"80-84 года",
"75-79 лет",
"70-74 лет",
"65-69 лет",
"60-64 лет"
))
deaths_plot <-
deaths_filter %>%
ggplot() +
geom_hline(yintercept = 0, size = 1, color = "#333333") +
geom_line(aes(x = as.Date(year, format = "%Y"),
y = value,
color = age), size = 1) +
bbc_style() +
scale_color_manual(
values = c("#990000",
"#588300",
"#AD08F9",
"#06BF8E",
"#FFA31E",
"#1380A1")
) +
labs(
title = "Количество смертей на 1 тысячу человек",
subtitle = glue("{deaths_filter$reg[1]}, городское население")
) +
guides(color = guide_legend(ncol = 2, byrow = FALSE))
finalise_plot(
deaths_plot,
save_filepath = glue("charts/{deaths_filter$reg[1]}.png"),
source_name = "Источник: Росстат"
)
deaths_filter <- deaths_urb %>%
filter(grepl("Дагест ", reg) &
age %in% age_groups)
deaths_filter$age <-
factor(deaths_filter$age,
levels = c(
"85 и старше",
"80-84 года",
"75-79 лет",
"70-74 лет",
"65-69 лет",
"60-64 лет"
))
deaths_plot <-
deaths_filter %>%
ggplot() +
geom_hline(yintercept = 0, size = 1, color = "#333333") +
geom_line(aes(x = as.Date(year, format = "%Y"),
y = value,
color = age), size = 1) +
bbc_style() +
scale_color_manual(
values = c("#990000",
"#588300",
"#AD08F9",
"#06BF8E",
"#FFA31E",
"#1380A1")
) +
labs(
title = "Количество смертей на 1 тысячу человек",
subtitle = glue("{deaths_filter$reg[1]}, городское население")
) +
guides(color = guide_legend(ncol = 2, byrow = FALSE))
finalise_plot(
deaths_plot,
save_filepath = glue("charts/{deaths_filter$reg[1]}.png"),
source_name = "Источник: Росстат"
)
deaths_filter <- deaths_urb %>%
filter(grepl("Дагест", reg) &
age %in% age_groups)
deaths_filter$age <-
factor(deaths_filter$age,
levels = c(
"85 и старше",
"80-84 года",
"75-79 лет",
"70-74 лет",
"65-69 лет",
"60-64 лет"
))
deaths_plot <-
deaths_filter %>%
ggplot() +
geom_hline(yintercept = 0, size = 1, color = "#333333") +
geom_line(aes(x = as.Date(year, format = "%Y"),
y = value,
color = age), size = 1) +
bbc_style() +
scale_color_manual(
values = c("#990000",
"#588300",
"#AD08F9",
"#06BF8E",
"#FFA31E",
"#1380A1")
) +
labs(
title = "Количество смертей на 1 тысячу человек",
subtitle = glue("{deaths_filter$reg[1]}, городское население")
) +
guides(color = guide_legend(ncol = 2, byrow = FALSE))
finalise_plot(
deaths_plot,
save_filepath = glue("charts/{deaths_filter$reg[1]}.png"),
source_name = "Источник: Росстат"
)
deaths_filter <- deaths_urb %>%
filter(grepl("Карач", reg) &
age %in% age_groups)
deaths_filter$age <-
factor(deaths_filter$age,
levels = c(
"85 и старше",
"80-84 года",
"75-79 лет",
"70-74 лет",
"65-69 лет",
"60-64 лет"
))
deaths_plot <-
deaths_filter %>%
ggplot() +
geom_hline(yintercept = 0, size = 1, color = "#333333") +
geom_line(aes(x = as.Date(year, format = "%Y"),
y = value,
color = age), size = 1) +
bbc_style() +
scale_color_manual(
values = c("#990000",
"#588300",
"#AD08F9",
"#06BF8E",
"#FFA31E",
"#1380A1")
) +
labs(
title = "Количество смертей на 1 тысячу человек",
subtitle = glue("{deaths_filter$reg[1]}, городское население")
) +
guides(color = guide_legend(ncol = 2, byrow = FALSE))
finalise_plot(
deaths_plot,
save_filepath = glue("charts/{deaths_filter$reg[1]}.png"),
source_name = "Источник: Росстат"
)
deaths_filter <- deaths_urb %>%
filter(grepl("Кабард", reg) &
age %in% age_groups)
deaths_filter$age <-
factor(deaths_filter$age,
levels = c(
"85 и старше",
"80-84 года",
"75-79 лет",
"70-74 лет",
"65-69 лет",
"60-64 лет"
))
deaths_plot <-
deaths_filter %>%
ggplot() +
geom_hline(yintercept = 0, size = 1, color = "#333333") +
geom_line(aes(x = as.Date(year, format = "%Y"),
y = value,
color = age), size = 1) +
bbc_style() +
scale_color_manual(
values = c("#990000",
"#588300",
"#AD08F9",
"#06BF8E",
"#FFA31E",
"#1380A1")
) +
labs(
title = "Количество смертей на 1 тысячу человек",
subtitle = glue("{deaths_filter$reg[1]}, городское население")
) +
guides(color = guide_legend(ncol = 2, byrow = FALSE))
finalise_plot(
deaths_plot,
save_filepath = glue("charts/{deaths_filter$reg[1]}.png"),
source_name = "Источник: Росстат"
)
deaths_filter <- deaths_urb %>%
filter(grepl("Ингуш", reg) &
age %in% age_groups)
deaths_filter$age <-
factor(deaths_filter$age,
levels = c(
"85 и старше",
"80-84 года",
"75-79 лет",
"70-74 лет",
"65-69 лет",
"60-64 лет"
))
deaths_plot <-
deaths_filter %>%
ggplot() +
geom_hline(yintercept = 0, size = 1, color = "#333333") +
geom_line(aes(x = as.Date(year, format = "%Y"),
y = value,
color = age), size = 1) +
bbc_style() +
scale_color_manual(
values = c("#990000",
"#588300",
"#AD08F9",
"#06BF8E",
"#FFA31E",
"#1380A1")
) +
labs(
title = "Количество смертей на 1 тысячу человек",
subtitle = glue("{deaths_filter$reg[1]}, городское население")
) +
guides(color = guide_legend(ncol = 2, byrow = FALSE))
finalise_plot(
deaths_plot,
save_filepath = glue("charts/{deaths_filter$reg[1]}.png"),
source_name = "Источник: Росстат"
)
age_groups <- unique(deaths$age)[!13:18]
deaths_filter <- deaths_urb %>%
filter(grepl("Российская", reg) &
age %in% age_groups)
deaths_filter %>%
ggplot() +
geom_hline(yintercept = 0, size = 1, color = "#333333") +
geom_line(aes(x = as.Date(year, format = "%Y"),
y = value,
color = age), size = 1) +
bbc_style() +
scale_color_manual(
values = c("#990000",
"#588300",
"#AD08F9",
"#06BF8E",
"#FFA31E",
"#1380A1")
) +
labs(
title = "Количество смертей на 1 тысячу человек",
subtitle = glue("{deaths_filter$reg[1]}, городское население")
) +
guides(color = guide_legend(ncol = 2, byrow = FALSE))
age_groups <- unique(deaths$age)[-(13:18)]
deaths_filter <- deaths_urb %>%
filter(grepl("Российская", reg) &
age %in% age_groups)
deaths_filter %>%
ggplot() +
geom_hline(yintercept = 0, size = 1, color = "#333333") +
geom_line(aes(x = as.Date(year, format = "%Y"),
y = value,
color = age), size = 1) +
bbc_style() +
scale_color_manual(
values = c("#990000",
"#588300",
"#AD08F9",
"#06BF8E",
"#FFA31E",
"#1380A1")
) +
labs(
title = "Количество смертей на 1 тысячу человек",
subtitle = glue("{deaths_filter$reg[1]}, городское население")
) +
guides(color = guide_legend(ncol = 2, byrow = FALSE))
deaths_filter %>%
ggplot() +
geom_hline(yintercept = 0, size = 1, color = "#333333") +
geom_line(aes(x = as.Date(year, format = "%Y"),
y = value,
color = age), size = 1) +
bbc_style() +
labs(
title = "Количество смертей на 1 тысячу человек",
subtitle = glue("{deaths_filter$reg[1]}, городское население")
) +
guides(color = guide_legend(ncol = 2, byrow = FALSE))
age_groups <- unique(deaths$age)[-(13:18)] %>% grepl(!"^0|^1", .)
age_groups <- unique(deaths$age)[-(13:18)] %>% grepl("^0|^1", .)
age_groups <- unique(deaths$age)[-(13:18)]
age_groups <- unique(deaths$age)[-(13:18)] %>% filter(!grepl("^0|^1", age_groups))
age_groups <- unique(deaths$age)[-(13:18)] %>% filter(!grepl("^0|^1", .))
x <- 'ABCDE'
grepl('^AB', x) # starts with AB?
grepl('DE$', x) # ends with DE?
substr(x, 1, 2) == 'AB'
substr('ABCDE', nchar(x)-1, nchar(x)) == 'DE'
age_groups <- unique(deaths$age)[-(13:18)]
age_groups <- age_groups[grepl("^0|^1", .))]
age_groups[grepl("^0|^1", .)]
age_groups[grepl("^0|^1", age_groups)]
age_groups[!grepl("^0|^1", age_groups)]
age_groups[!grepl("^0|^1|5-", age_groups)]
age_groups[!grepl("^0|^1|5-|Всего", age_groups)]
age_groups[!grepl("^0|^1|5-|Всего|от", age_groups)]
age_groups <- unique(deaths$age)[-(13:18)]
age_groups <- age_groups[!grepl("^0|^1|5-|Всего|от", age_groups)]
deaths_filter <- deaths_urb %>%
filter(grepl("Российская", reg) &
age %in% age_groups)
deaths_filter %>%
ggplot() +
geom_hline(yintercept = 0, size = 1, color = "#333333") +
geom_line(aes(x = as.Date(year, format = "%Y"),
y = value,
color = age), size = 1) +
bbc_style() +
labs(
title = "Количество смертей на 1 тысячу человек",
subtitle = glue("{deaths_filter$reg[1]}, городское население")
) +
guides(color = guide_legend(ncol = 2, byrow = FALSE))
unique(deaths$age)[-(13:18)]
age_groups <- unique(deaths$age)[-(13:18)]
age_groups <- age_groups[grepl("^0|^1|5-|Всего|от", age_groups)]
deaths_urb <- deaths %>%
filter(area == "городское население" &
year > 2010 &
gender == "Оба пола") %>%
select(-area, -promille)
deaths_filter %>%
ggplot() +
geom_hline(yintercept = 0, size = 1, color = "#333333") +
geom_line(aes(x = as.Date(year, format = "%Y"),
y = value,
color = age), size = 1) +
bbc_style() +
labs(
title = "Количество смертей на 1 тысячу человек",
subtitle = glue("{deaths_filter$reg[1]}, городское население")
) +
guides(color = guide_legend(ncol = 2, byrow = FALSE))
deaths_filter <- deaths_urb %>%
filter(grepl("Российская", reg) &
age %in% age_groups)
deaths_filter %>%
ggplot() +
geom_hline(yintercept = 0, size = 1, color = "#333333") +
geom_line(aes(x = as.Date(year, format = "%Y"),
y = value,
color = age), size = 1) +
bbc_style() +
labs(
title = "Количество смертей на 1 тысячу человек",
subtitle = glue("{deaths_filter$reg[1]}, городское население")
) +
guides(color = guide_legend(ncol = 2, byrow = FALSE))
age_groups[grepl("^0|^1|5-|Всего|от", age_groups)]
age_groups <- age_groups[grepl("^0|^1|^5-|^Всего|^от", age_groups)]
age_groups
deaths_urb <- deaths %>%
filter(area == "городское население" &
year > 2010 &
gender == "Оба пола") %>%
select(-area, -promille)
deaths_filter <- deaths_urb %>%
filter(grepl("Российская", reg) &
age %in% age_groups)
deaths_filter %>%
ggplot() +
geom_hline(yintercept = 0, size = 1, color = "#333333") +
geom_line(aes(x = as.Date(year, format = "%Y"),
y = value,
color = age), size = 1) +
bbc_style() +
labs(
title = "Количество смертей на 1 тысячу человек",
subtitle = glue("{deaths_filter$reg[1]}, городское население")
) +
guides(color = guide_legend(ncol = 2, byrow = FALSE))
age_groups <- unique(deaths$age)[-(13:18)]
age_groups <- age_groups[grepl("^0|^1|^5-|^от", age_groups)]
deaths_filter <- deaths_urb %>%
filter(grepl("Российская", reg) &
age %in% age_groups)
deaths_filter %>%
ggplot() +
geom_hline(yintercept = 0, size = 1, color = "#333333") +
geom_line(aes(x = as.Date(year, format = "%Y"),
y = value,
color = age), size = 1) +
bbc_style() +
labs(
title = "Количество смертей на 1 тысячу человек",
subtitle = glue("{deaths_filter$reg[1]}, городское население")
) +
guides(color = guide_legend(ncol = 2, byrow = FALSE))
age_groups <- unique(deaths$age)[-(13:18)]
age_groups <- age_groups[grepl("^0-4|^1|^5-|^от", age_groups)]
deaths_filter <- deaths_urb %>%
filter(grepl("Российская", reg) &
age %in% age_groups)
deaths_filter %>%
ggplot() +
geom_hline(yintercept = 0, size = 1, color = "#333333") +
geom_line(aes(x = as.Date(year, format = "%Y"),
y = value,
color = age), size = 1) +
bbc_style() +
labs(
title = "Количество смертей на 1 тысячу человек",
subtitle = glue("{deaths_filter$reg[1]}, городское население")
) +
guides(color = guide_legend(ncol = 2, byrow = FALSE))
age_groups <- unique(deaths$age)[(13:18)]
age_groups <- unique(deaths$age)[(13:18)]
deaths_filter <- deaths_urb %>%
filter(grepl("Российская", reg) &
age %in% age_groups)
deaths_filter$age <-
factor(deaths_filter$age,
levels = c(
"85 и старше",
"80-84 года",
"75-79 лет",
"70-74 лет",
"65-69 лет",
"60-64 лет"
))
deaths_filter %>%
ggplot() +
geom_hline(yintercept = 0, size = 1, color = "#333333") +
geom_line(aes(x = as.Date(year, format = "%Y"),
y = value,
color = age), size = 1) +
bbc_style() +
labs(
title = "Количество смертей на 1 тысячу человек",
subtitle = glue("{deaths_filter$reg[1]}, городское население")
) +
guides(color = guide_legend(ncol = 2, byrow = FALSE))
View(deaths_urb)
deaths_filter <- deaths_urb %>%
filter(grepl("Российская", reg) &
age == "Всего")
deaths_filter %>%
ggplot() +
geom_hline(yintercept = 0, size = 1, color = "#333333") +
geom_line(aes(x = as.Date(year, format = "%Y"),
y = value,
color = age), size = 1) +
bbc_style() +
labs(
title = "Количество смертей на 1 тысячу человек",
subtitle = glue("{deaths_filter$reg[1]}, городское население")
) +
guides(color = guide_legend(ncol = 2, byrow = FALSE))
View(deaths_filter)
deaths_urb <- deaths %>%
filter(area == "городское население" &
year > 1990 &
gender == "Оба пола") %>%
select(-area, -promille)
deaths_filter <- deaths_urb %>%
filter(grepl("Российская", reg) &
age == "Всего")
deaths_filter %>%
ggplot() +
geom_hline(yintercept = 0, size = 1, color = "#333333") +
geom_line(aes(x = as.Date(year, format = "%Y"),
y = value,
color = age), size = 1) +
bbc_style() +
labs(
title = "Количество смертей на 1 тысячу человек",
subtitle = glue("{deaths_filter$reg[1]}, городское население")
) +
guides(color = guide_legend(ncol = 2, byrow = FALSE))
